namespace Sain.SDL3;

internal enum SDL3_ScanCode : ushort
{
   UNKNOWN = 0,
   A = 4,
   B = 5,
   C = 6,
   D = 7,
   E = 8,
   F = 9,
   G = 10,
   H = 11,
   I = 12,
   J = 13,
   K = 14,
   L = 15,
   M = 16,
   N = 17,
   O = 18,
   P = 19,
   Q = 20,
   R = 21,
   S = 22,
   T = 23,
   U = 24,
   V = 25,
   W = 26,
   X = 27,
   Y = 28,
   Z = 29,
   Number1 = 30,
   Number2 = 31,
   Number3 = 32,
   Number4 = 33,
   Number5 = 34,
   Number6 = 35,
   Number7 = 36,
   Number8 = 37,
   Number9 = 38,
   Number0 = 39,
   RETURN = 40,
   ESCAPE = 41,
   BACKSPACE = 42,
   TAB = 43,
   SPACE = 44,
   MINUS = 45,
   EQUALS = 46,
   LEFTBRACKET = 47,
   RIGHTBRACKET = 48,
   BACKSLASH = 49,
   NONUSHASH = 50,
   SEMICOLON = 51,
   APOSTROPHE = 52,
   GRAVE = 53,
   COMMA = 54,
   PERIOD = 55,
   SLASH = 56,
   CAPSLOCK = 57,
   F1 = 58,
   F2 = 59,
   F3 = 60,
   F4 = 61,
   F5 = 62,
   F6 = 63,
   F7 = 64,
   F8 = 65,
   F9 = 66,
   F10 = 67,
   F11 = 68,
   F12 = 69,
   PRINTSCREEN = 70,
   SCROLLLOCK = 71,
   PAUSE = 72,
   INSERT = 73,
   HOME = 74,
   PAGEUP = 75,
   DELETE = 76,
   END = 77,
   PAGEDOWN = 78,
   RIGHT = 79,
   LEFT = 80,
   DOWN = 81,
   UP = 82,
   NUMLOCKCLEAR = 83,
   Keypad_DIVIDE = 84,
   Keypad_MULTIPLY = 85,
   Keypad_MINUS = 86,
   Keypad_PLUS = 87,
   Keypad_ENTER = 88,
   Keypad_1 = 89,
   Keypad_2 = 90,
   Keypad_3 = 91,
   Keypad_4 = 92,
   Keypad_5 = 93,
   Keypad_6 = 94,
   Keypad_7 = 95,
   Keypad_8 = 96,
   Keypad_9 = 97,
   Keypad_0 = 98,
   Keypad_PERIOD = 99,
   NONUSBACKSLASH = 100,
   APPLICATION = 101,
   POWER = 102,
   Keypad_EQUALS = 103,
   F13 = 104,
   F14 = 105,
   F15 = 106,
   F16 = 107,
   F17 = 108,
   F18 = 109,
   F19 = 110,
   F20 = 111,
   F21 = 112,
   F22 = 113,
   F23 = 114,
   F24 = 115,
   EXECUTE = 116,
   HELP = 117,
   MENU = 118,
   SELECT = 119,
   STOP = 120,
   AGAIN = 121,
   UNDO = 122,
   CUT = 123,
   COPY = 124,
   PASTE = 125,
   FIND = 126,
   MUTE = 127,
   VOLUMEUP = 128,
   VOLUMEDOWN = 129,
   Keypad_COMMA = 133,
   Keypad_EQUALSAS400 = 134,
   INTERNATIONAL1 = 135,
   INTERNATIONAL2 = 136,
   INTERNATIONAL3 = 137,
   INTERNATIONAL4 = 138,
   INTERNATIONAL5 = 139,
   INTERNATIONAL6 = 140,
   INTERNATIONAL7 = 141,
   INTERNATIONAL8 = 142,
   INTERNATIONAL9 = 143,
   LANG1 = 144,
   LANG2 = 145,
   LANG3 = 146,
   LANG4 = 147,
   LANG5 = 148,
   LANG6 = 149,
   LANG7 = 150,
   LANG8 = 151,
   LANG9 = 152,
   ALTERASE = 153,
   SYSREQ = 154,
   CANCEL = 155,
   CLEAR = 156,
   PRIOR = 157,
   RETURN2 = 158,
   SEPARATOR = 159,
   OUT = 160,
   OPER = 161,
   CLEARAGAIN = 162,
   CRSEL = 163,
   EXSEL = 164,
   Keypad_00 = 176,
   Keypad_000 = 177,
   THOUSANDSSEPARATOR = 178,
   DECIMALSEPARATOR = 179,
   CURRENCYUNIT = 180,
   CURRENCYSUBUNIT = 181,
   Keypad_LEFTPAREN = 182,
   Keypad_RIGHTPAREN = 183,
   Keypad_LEFTBRACE = 184,
   Keypad_RIGHTBRACE = 185,
   Keypad_TAB = 186,
   Keypad_BACKSPACE = 187,
   Keypad_A = 188,
   Keypad_B = 189,
   Keypad_C = 190,
   Keypad_D = 191,
   Keypad_E = 192,
   Keypad_F = 193,
   Keypad_XOR = 194,
   Keypad_POWER = 195,
   Keypad_PERCENT = 196,
   Keypad_LESS = 197,
   Keypad_GREATER = 198,
   Keypad_AMPERSAND = 199,
   Keypad_DBLAMPERSAND = 200,
   Keypad_VERTICALBAR = 201,
   Keypad_DBLVERTICALBAR = 202,
   Keypad_COLON = 203,
   Keypad_HASH = 204,
   Keypad_SPACE = 205,
   Keypad_AT = 206,
   Keypad_EXCLAM = 207,
   Keypad_MEMSTORE = 208,
   Keypad_MEMRECALL = 209,
   Keypad_MEMCLEAR = 210,
   Keypad_MEMADD = 211,
   Keypad_MEMSUBTRACT = 212,
   Keypad_MEMMULTIPLY = 213,
   Keypad_MEMDIVIDE = 214,
   Keypad_PLUSMINUS = 215,
   Keypad_CLEAR = 216,
   Keypad_CLEARENTRY = 217,
   Keypad_BINARY = 218,
   Keypad_OCTAL = 219,
   Keypad_DECIMAL = 220,
   Keypad_HEXADECIMAL = 221,
   LCTRL = 224,
   LSHIFT = 225,
   LALT = 226,
   LGUI = 227,
   RCTRL = 228,
   RSHIFT = 229,
   RALT = 230,
   RGUI = 231,
   MODE = 257,
   SLEEP = 258,
   WAKE = 259,
   CHANNEL_INCREMENT = 260,
   CHANNEL_DECREMENT = 261,
   MEDIA_PLAY = 262,
   MEDIA_PAUSE = 263,
   MEDIA_RECORD = 264,
   MEDIA_FAST_FORWARD = 265,
   MEDIA_REWIND = 266,
   MEDIA_NEXT_TRACK = 267,
   MEDIA_PREVIOUS_TRACK = 268,
   MEDIA_STOP = 269,
   MEDIA_EJECT = 270,
   MEDIA_PLAY_PAUSE = 271,
   MEDIA_SELECT = 272,
   AC_NEW = 273,
   AC_OPEN = 274,
   AC_CLOSE = 275,
   AC_EXIT = 276,
   AC_SAVE = 277,
   AC_PRINT = 278,
   AC_PROPERTIES = 279,
   AC_SEARCH = 280,
   AC_HOME = 281,
   AC_BACK = 282,
   AC_FORWARD = 283,
   AC_STOP = 284,
   AC_REFRESH = 285,
   AC_BOOKMARKS = 286,
   SOFTLEFT = 287,
   SOFTRIGHT = 288,
   CALL = 289,
   ENDCALL = 290,
   RESERVED = 400,
}

internal enum SDL3_KeyCode : uint
{
   UNKNOWN = 0,
   RETURN = 0xdu,
   ESCAPE = 0x1bu,
   BACKSPACE = 0x8u,
   TAB = 0x9u,
   SPACE = 0x20u,
   EXCLAIM = 0x21u,
   DBLAPOSTROPHE = 0x22u,
   HASH = 0x23u,
   DOLLAR = 0x24u,
   PERCENT = 0x25u,
   AMPERSAND = 0x26u,
   APOSTROPHE = 0x27u,
   LEFTPAREN = 0x28u,
   RIGHTPAREN = 0x29u,
   ASTERISK = 0x2au,
   PLUS = 0x2bu,
   COMMA = 0x2cu,
   MINUS = 0x2du,
   PERIOD = 0x2eu,
   SLASH = 0x2fu,
   Number_0 = 0x30u,
   Number_1 = 0x31u,
   Number_2 = 0x32u,
   Number_3 = 0x33u,
   Number_4 = 0x34u,
   Number_5 = 0x35u,
   Number_6 = 0x36u,
   Number_7 = 0x37u,
   Number_8 = 0x38u,
   Number_9 = 0x39u,
   COLON = 0x3au,
   SEMICOLON = 0x3bu,
   LESS = 0x3cu,
   EQUALS = 0x3du,
   GREATER = 0x3eu,
   QUESTION = 0x3fu,
   AT = 0x40u,
   LEFTBRACKET = 0x5bu,
   BACKSLASH = 0x5cu,
   RIGHTBRACKET = 0x5du,
   CARET = 0x5eu,
   UNDERSCORE = 0x5fu,
   GRAVE = 0x60u,
   A = 0x61u,
   B = 0x62u,
   C = 0x63u,
   D = 0x64u,
   E = 0x65u,
   F = 0x66u,
   G = 0x67u,
   H = 0x68u,
   I = 0x69u,
   J = 0x6au,
   K = 0x6bu,
   L = 0x6cu,
   M = 0x6du,
   N = 0x6eu,
   O = 0x6fu,
   P = 0x70u,
   Q = 0x71u,
   R = 0x72u,
   S = 0x73u,
   T = 0x74u,
   U = 0x75u,
   V = 0x76u,
   W = 0x77u,
   X = 0x78u,
   Y = 0x79u,
   Z = 0x7au,
   LEFTBRACE = 0x7bu,
   PIPE = 0x7cu,
   RIGHTBRACE = 0x7du,
   TILDE = 0x7eu,
   DELETE = 0x7fu,
   PLUSMINUS = 0xb1u,
   CAPSLOCK = 0x40000039u,
   F1 = 0x4000003au,
   F2 = 0x4000003bu,
   F3 = 0x4000003cu,
   F4 = 0x4000003du,
   F5 = 0x4000003eu,
   F6 = 0x4000003fu,
   F7 = 0x40000040u,
   F8 = 0x40000041u,
   F9 = 0x40000042u,
   F10 = 0x40000043u,
   F11 = 0x40000044u,
   F12 = 0x40000045u,
   PRINTSCREEN = 0x40000046u,
   SCROLLLOCK = 0x40000047u,
   PAUSE = 0x40000048u,
   INSERT = 0x40000049u,
   HOME = 0x4000004au,
   PAGEUP = 0x4000004bu,
   END = 0x4000004du,
   PAGEDOWN = 0x4000004eu,
   RIGHT = 0x4000004fu,
   LEFT = 0x40000050u,
   DOWN = 0x40000051u,
   UP = 0x40000052u,
   NUMLOCKCLEAR = 0x40000053u,
   Keypad_DIVIDE = 0x40000054u,
   Keypad_MULTIPLY = 0x40000055u,
   Keypad_MINUS = 0x40000056u,
   Keypad_PLUS = 0x40000057u,
   Keypad_ENTER = 0x40000058u,
   Keypad_1 = 0x40000059u,
   Keypad_2 = 0x4000005au,
   Keypad_3 = 0x4000005bu,
   Keypad_4 = 0x4000005cu,
   Keypad_5 = 0x4000005du,
   Keypad_6 = 0x4000005eu,
   Keypad_7 = 0x4000005fu,
   Keypad_8 = 0x40000060u,
   Keypad_9 = 0x40000061u,
   Keypad_0 = 0x40000062u,
   Keypad_PERIOD = 0x40000063u,
   APPLICATION = 0x40000065u,
   POWER = 0x40000066u,
   Keypad_EQUALS = 0x40000067u,
   F13 = 0x40000068u,
   F14 = 0x40000069u,
   F15 = 0x4000006au,
   F16 = 0x4000006bu,
   F17 = 0x4000006cu,
   F18 = 0x4000006du,
   F19 = 0x4000006eu,
   F20 = 0x4000006fu,
   F21 = 0x40000070u,
   F22 = 0x40000071u,
   F23 = 0x40000072u,
   F24 = 0x40000073u,
   EXECUTE = 0x40000074u,
   HELP = 0x40000075u,
   MENU = 0x40000076u,
   SELECT = 0x40000077u,
   STOP = 0x40000078u,
   AGAIN = 0x40000079u,
   UNDO = 0x4000007au,
   CUT = 0x4000007bu,
   COPY = 0x4000007cu,
   PASTE = 0x4000007du,
   FIND = 0x4000007eu,
   MUTE = 0x4000007fu,
   VOLUMEUP = 0x40000080u,
   VOLUMEDOWN = 0x40000081u,
   Keypad_COMMA = 0x40000085u,
   Keypad_EQUALSAS400 = 0x40000086u,
   ALTERASE = 0x40000099u,
   SYSREQ = 0x4000009au,
   CANCEL = 0x4000009bu,
   CLEAR = 0x4000009cu,
   PRIOR = 0x4000009du,
   RETURN2 = 0x4000009eu,
   SEPARATOR = 0x4000009fu,
   OUT = 0x400000a0u,
   OPER = 0x400000a1u,
   CLEARAGAIN = 0x400000a2u,
   CRSEL = 0x400000a3u,
   EXSEL = 0x400000a4u,
   Keypad_00 = 0x400000b0u,
   Keypad_000 = 0x400000b1u,
   THOUSANDSSEPARATOR = 0x400000b2u,
   DECIMALSEPARATOR = 0x400000b3u,
   CURRENCYUNIT = 0x400000b4u,
   CURRENCYSUBUNIT = 0x400000b5u,
   Keypad_LEFTPAREN = 0x400000b6u,
   Keypad_RIGHTPAREN = 0x400000b7u,
   Keypad_LEFTBRACE = 0x400000b8u,
   Keypad_RIGHTBRACE = 0x400000b9u,
   Keypad_TAB = 0x400000bau,
   Keypad_BACKSPACE = 0x400000bbu,
   Keypad_A = 0x400000bcu,
   Keypad_B = 0x400000bdu,
   Keypad_C = 0x400000beu,
   Keypad_D = 0x400000bfu,
   Keypad_E = 0x400000c0u,
   Keypad_F = 0x400000c1u,
   Keypad_XOR = 0x400000c2u,
   Keypad_POWER = 0x400000c3u,
   Keypad_PERCENT = 0x400000c4u,
   Keypad_LESS = 0x400000c5u,
   Keypad_GREATER = 0x400000c6u,
   Keypad_AMPERSAND = 0x400000c7u,
   Keypad_DBLAMPERSAND = 0x400000c8u,
   Keypad_VERTICALBAR = 0x400000c9u,
   Keypad_DBLVERTICALBAR = 0x400000cau,
   Keypad_COLON = 0x400000cbu,
   Keypad_HASH = 0x400000ccu,
   Keypad_SPACE = 0x400000cdu,
   Keypad_AT = 0x400000ceu,
   Keypad_EXCLAM = 0x400000cfu,
   Keypad_MEMSTORE = 0x400000d0u,
   Keypad_MEMRECALL = 0x400000d1u,
   Keypad_MEMCLEAR = 0x400000d2u,
   Keypad_MEMADD = 0x400000d3u,
   Keypad_MEMSUBTRACT = 0x400000d4u,
   Keypad_MEMMULTIPLY = 0x400000d5u,
   Keypad_MEMDIVIDE = 0x400000d6u,
   Keypad_PLUSMINUS = 0x400000d7u,
   Keypad_CLEAR = 0x400000d8u,
   Keypad_CLEARENTRY = 0x400000d9u,
   Keypad_BINARY = 0x400000dau,
   Keypad_OCTAL = 0x400000dbu,
   Keypad_DECIMAL = 0x400000dcu,
   Keypad_HEXADECIMAL = 0x400000ddu,
   LCTRL = 0x400000e0u,
   LSHIFT = 0x400000e1u,
   LALT = 0x400000e2u,
   LGUI = 0x400000e3u,
   RCTRL = 0x400000e4u,
   RSHIFT = 0x400000e5u,
   RALT = 0x400000e6u,
   RGUI = 0x400000e7u,
   MODE = 0x40000101u,
   SLEEP = 0x40000102u,
   WAKE = 0x40000103u,
   CHANNEL_INCREMENT = 0x40000104u,
   CHANNEL_DECREMENT = 0x40000105u,
   MEDIA_PLAY = 0x40000106u,
   MEDIA_PAUSE = 0x40000107u,
   MEDIA_RECORD = 0x40000108u,
   MEDIA_FAST_FORWARD = 0x40000109u,
   MEDIA_REWIND = 0x4000010au,
   MEDIA_NEXT_TRACK = 0x4000010bu,
   MEDIA_PREVIOUS_TRACK = 0x4000010cu,
   MEDIA_STOP = 0x4000010du,
   MEDIA_EJECT = 0x4000010eu,
   MEDIA_PLAY_PAUSE = 0x4000010fu,
   MEDIA_SELECT = 0x40000110u,
   AC_NEW = 0x40000111u,
   AC_OPEN = 0x40000112u,
   AC_CLOSE = 0x40000113u,
   AC_EXIT = 0x40000114u,
   AC_SAVE = 0x40000115u,
   AC_PRINT = 0x40000116u,
   AC_PROPERTIES = 0x40000117u,
   AC_SEARCH = 0x40000118u,
   AC_HOME = 0x40000119u,
   AC_BACK = 0x4000011au,
   AC_FORWARD = 0x4000011bu,
   AC_STOP = 0x4000011cu,
   AC_REFRESH = 0x4000011du,
   AC_BOOKMARKS = 0x4000011eu,
   SOFTLEFT = 0x4000011fu,
   SOFTRIGHT = 0x40000120u,
   CALL = 0x40000121u,
   ENDCALL = 0x40000122u,
}

[Flags]
internal enum SDL3_KeyModifiers : ushort
{
   None = 0,
   LeftShift = 0x1,
   RightShift = 0x2,
   LeftControl = 0x40,
   RightControl = 0x80,
   LeftAlt = 0x100,
   RightAlt = 0x200,
   LeftMeta = 0x400,
   RightMeta = 0x800,
   NumLock = 0x1000,
   CapsLock = 0x2000,
   Mode = 0x4000,
   ScrollLock = 0x8000,
}

[StructLayout(LayoutKind.Sequential)]
internal readonly struct SDL3_KeyboardId(uint id)
{
   #region Fields
   public readonly uint Id = id;
   #endregion

   #region Methods
   public override string ToString() => Id.ToString();
   #endregion
}

[StructLayout(LayoutKind.Sequential)]
internal readonly struct SDL3_KeyboardDeviceEvent
{
   #region Fields
   public readonly SDL3_CommonEvent Common;
   public readonly SDL3_KeyboardId KeyboardId;
   #endregion

   #region Properties
   public readonly SDL3_EventType Type => Common.Type;
   #endregion
}

[StructLayout(LayoutKind.Sequential)]
internal readonly struct SDL3_KeyboardEvent
{
   #region Fields
   public readonly SDL3_CommonEvent Common;
   public readonly SDL3_WindowId WindowId;
   public readonly SDL3_KeyboardId KeyboardId;
   public readonly SDL3_ScanCode ScanCode;
   public readonly SDL3_KeyCode KeyCode;
   public readonly SDL3_KeyModifiers Modifiers;
   private readonly ushort _raw;
   private readonly byte _isDown;
   private readonly byte _isRepeat;
   #endregion

   #region Properties
   public readonly SDL3_EventType Type => Common.Type;
   public readonly bool IsDown => _isDown is not 0;
   public readonly bool IsRepeat => _isRepeat is not 0;
   #endregion
}

[StructLayout(LayoutKind.Sequential)]
internal readonly unsafe struct SDL3_TextInputEvent
{
   #region Fields
   public readonly SDL3_CommonEvent Common;
   public readonly SDL3_WindowId WindowId;
   private readonly byte* _text;
   #endregion

   #region Properties
   public readonly SDL3_EventType Type => Common.Type;
   public string Text
   {
      get
      {
         string? value = Utf8StringMarshaller.ConvertToManaged(_text);
         Debug.Assert(string.IsNullOrEmpty(value) is false);
         return value ?? string.Empty;
      }
   }
   #endregion
}

static unsafe partial class Native
{
   #region Functions
   [LibraryImport(LibName, EntryPoint = "SDL_StartTextInput")]
   [return: MarshalAs(Bool)]
   public static partial bool StartTextInput(SDL3_Window* window);

   [LibraryImport(LibName, EntryPoint = "SDL_StopTextInput")]
   [return: MarshalAs(Bool)]
   public static partial bool StopTextInput(SDL3_Window* window);

   [LibraryImport(LibName, EntryPoint = "SDL_GetKeyName")]
   private static partial byte* _GetKeyName(SDL3_KeyCode key);
   public static string GetKeyName(SDL3_KeyCode key)
   {
      byte* native = _GetKeyName(key);
      return Utf8StringMarshaller.ConvertToManaged(native) ?? string.Empty;
   }

   [LibraryImport(LibName, EntryPoint = "SDL_GetScancodeName")]
   private static partial byte* _GetScanCodeName(SDL3_ScanCode scanCode);
   public static string GetScanCodeName(SDL3_ScanCode scanCode)
   {
      byte* native = _GetScanCodeName(scanCode);
      return Utf8StringMarshaller.ConvertToManaged(native) ?? string.Empty;
   }

   [LibraryImport(LibName, EntryPoint = "SDL_GetKeyboardNameForID")]
   private static partial byte* _GetKeyboardNameForId(SDL3_KeyboardId keyboardId);
   public static string? GetKeyboardNameForId(SDL3_KeyboardId keyboardId)
   {
      byte* native = _GetKeyboardNameForId(keyboardId);
      return Utf8StringMarshaller.ConvertToManaged(native);
   }

   [LibraryImport(LibName, EntryPoint = "SDL_GetKeyboards")]
   public static partial SDL3_KeyboardId* GetKeyboards(out int count);

   [LibraryImport(LibName, EntryPoint = "SDL_GetKeyboardState")]
   public static partial byte* GetKeyboardState(out int count);

   [LibraryImport(LibName, EntryPoint = "SDL_SetTextInputArea")]
   [return: MarshalAs(Bool)]
   private static partial bool _SetTextInputArea(SDL3_Window* window, SDL3_Rect* rect, int cursorOffset);
   public static bool SetTextInputArea(SDL3_Window* window, Rectangle area, double cursorOffset)
   {
      SDL3_Rect rect = area;
      int offset = (int)cursorOffset;

      return _SetTextInputArea(window, &rect, offset);
   }
   public static bool SetTextInputArea(SDL3_Window* window) => _SetTextInputArea(window, null, 0);
   #endregion
}
